\section{OWLinstaller Class Reference}
\label{classOWLinstaller}\index{OWLinstaller@{OWLinstaller}}


Application installer.  


\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static {\bf construct} ()
\item 
static {\bf installApplication} (\$code, \$name, \$version, \$description= '', \$link= '', \$author= '', \$license= '')
\item 
static {\bf enableApplication} (\$id)
\item 
static {\bf parseSQLFile} (\$fname)
\item 
static {\bf installTables} (\$sqlFile, \$prefix=null)
\item 
static {\bf addGroupRights} (\$aid, \$grp, array \$rights)
\item 
static {\bf addGroups} (\$aid, array \$grps)
\item 
static {\bf addRights} (\$aid, array \$rights)
\item 
static {\bf addConfig} (\$aid, \$item, \$value, \$protect=false, \$hide=false, \$group=null)
\end{DoxyCompactItemize}
\subsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static {\bf uncommentSQL} (\$line)
\item 
static {\bf addTablePrefix} (\$q, \$prefix)
\end{DoxyCompactItemize}
\subsection*{Static Private Attributes}
\begin{DoxyCompactItemize}
\item 
static {\bf \$rights} = array()
\item 
static {\bf \$groups} = array()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Application installer. 

Abstract class to install applications \begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
Apr 19, 2011 -\/-\/ O van Eijk -\/-\/ Initial version for OWL-\/PHP 
\end{DoxyVersion}


\subsection{Member Function Documentation}
\index{OWLinstaller@{OWLinstaller}!addConfig@{addConfig}}
\index{addConfig@{addConfig}!OWLinstaller@{OWLinstaller}}
\subsubsection[{addConfig}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::addConfig (
\begin{DoxyParamCaption}
\item[{\$}]{aid, }
\item[{\$}]{item, }
\item[{\$}]{value, }
\item[{\$}]{protect = {\ttfamily false}, }
\item[{\$}]{hide = {\ttfamily false}, }
\item[{\$}]{group = {\ttfamily null}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static]}}\label{classOWLinstaller_a2c93d2eed7940a681a463d46a1083089}
Add an application specific dynamic config item. It is set or overwritten in the current configuration immediately. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$aid} & Application ID \\
\hline
\mbox{\tt in}  & {\em \$item} & Name of the configuration item in the same format it appears in the configuration file (e.g. 'group$|$subject$|$item) \\
\hline
\mbox{\tt in}  & {\em \$value} & Value of the configuration item \\
\hline
\mbox{\tt in}  & {\em \$protect} & True if this is a protected item \\
\hline
\mbox{\tt in}  & {\em \$hide} & True if this is an hidden item \\
\hline
\mbox{\tt in}  & {\em \$group} & An optional groupname to which this item belongs \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Boolean indicating success (true) or any failure (false) 
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}


References ConfigHandler::get(), and ConfigHandler::set().

\index{OWLinstaller@{OWLinstaller}!addGroupRights@{addGroupRights}}
\index{addGroupRights@{addGroupRights}!OWLinstaller@{OWLinstaller}}
\subsubsection[{addGroupRights}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::addGroupRights (
\begin{DoxyParamCaption}
\item[{\$}]{aid, }
\item[{\$}]{grp, }
\item[{array \$}]{rights}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static]}}\label{classOWLinstaller_a6f8db3684178332da05b3dc15b9f3648}
Set the rights bitvalue for a given group 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$aid} & Application ID. \\
\hline
\mbox{\tt in}  & {\em \$grp} & \doxyref{Group}{p.}{classGroup} name. This can be an existing \doxyref{OWL}{p.}{classOWL} group \\
\hline
\mbox{\tt in}  & {\em \$rights} & Array with right identifiers \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Boolean indicating success (true) or any failure (false) 
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}


References ConfigHandler::get().

\index{OWLinstaller@{OWLinstaller}!addGroups@{addGroups}}
\index{addGroups@{addGroups}!OWLinstaller@{OWLinstaller}}
\subsubsection[{addGroups}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::addGroups (
\begin{DoxyParamCaption}
\item[{\$}]{aid, }
\item[{array \$}]{grps}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static]}}\label{classOWLinstaller_a58006b3763431df6b723a51b2a7d35fb}
Add the application specific groups to the database 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$aid} & Application ID \\
\hline
\mbox{\tt in}  & {\em \$grps} & Array of groups in the format (groupname =$>$ groupdescription) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Boolean indicating success (true) or any failure (false) 
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}


References ConfigHandler::get().

\index{OWLinstaller@{OWLinstaller}!addRights@{addRights}}
\index{addRights@{addRights}!OWLinstaller@{OWLinstaller}}
\subsubsection[{addRights}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::addRights (
\begin{DoxyParamCaption}
\item[{\$}]{aid, }
\item[{array \$}]{rights}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static]}}\label{classOWLinstaller_aa6571c34c5e4e40a3684ea6a11386d48}
Add the application specific rights to the database 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$aid} & Application ID \\
\hline
\mbox{\tt in}  & {\em \$rights} & Array of rights in the format name =$>$ description \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Boolean indicating success (true) or any failure (false) 
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}


References ConfigHandler::get().

\index{OWLinstaller@{OWLinstaller}!addTablePrefix@{addTablePrefix}}
\index{addTablePrefix@{addTablePrefix}!OWLinstaller@{OWLinstaller}}
\subsubsection[{addTablePrefix}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::addTablePrefix (
\begin{DoxyParamCaption}
\item[{\$}]{q, }
\item[{\$}]{prefix}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static, private]}}\label{classOWLinstaller_ac53f7e652c448c66c8fd4a81bfc95be1}
Check an SQL statement and lok for table names. When a tablename has been found, the table prefix will be added.

The following SQL queries are supported by the regular expressions (with and without backticks):
\begin{DoxyItemize}
\item CREATE [TEMPORARY] TABLE [IF NOT EXISTS] `tblname`
\item ALTER [IGNORE] TABLE `tblname`
\item DROP [TEMPORARY] TABLE [IF EXISTS] `tblname`
\item INSERT [insert type] [IGNORE] [INTO] `tblname` (...)
\item CREATE [type] INDEX [name] [using type] ON `tblname` (...) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$q} & SQL query \\
\hline
\mbox{\tt in}  & {\em \$prefix} & Prefix, or null to use the default \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
SQL statement with the prefixed tablename 
\end{DoxyReturn}
\begin{Desc}
\item[{\bf Todo}]Add support for UPDATE, DELETE, RENAME and other statements that $\ast$might$\ast$ occur in SQL install files 

Handle constraints ([...] REFERENCES `tblname` (...)) \end{Desc}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}

\end{DoxyItemize}

References ConfigHandler::get().



Referenced by installTables().

\index{OWLinstaller@{OWLinstaller}!construct@{construct}}
\index{construct@{construct}!OWLinstaller@{OWLinstaller}}
\subsubsection[{construct}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::construct (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static]}}\label{classOWLinstaller_adca94d428f4798c78100527c51fc11ff}
Preload \doxyref{OWL}{p.}{classOWL} data that can be used during the application install \begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}


References ConfigHandler::get().

\index{OWLinstaller@{OWLinstaller}!enableApplication@{enableApplication}}
\index{enableApplication@{enableApplication}!OWLinstaller@{OWLinstaller}}
\subsubsection[{enableApplication}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::enableApplication (
\begin{DoxyParamCaption}
\item[{\$}]{id}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static]}}\label{classOWLinstaller_a381aeca103d4f10cf0d4edc7e436f4e7}
Enable an application 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$id} & Application ID \\
\hline
\end{DoxyParams}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}


References ConfigHandler::get().

\index{OWLinstaller@{OWLinstaller}!installApplication@{installApplication}}
\index{installApplication@{installApplication}!OWLinstaller@{OWLinstaller}}
\subsubsection[{installApplication}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::installApplication (
\begin{DoxyParamCaption}
\item[{\$}]{code, }
\item[{\$}]{name, }
\item[{\$}]{version, }
\item[{\$}]{description = {\ttfamily ''}, }
\item[{\$}]{link = {\ttfamily ''}, }
\item[{\$}]{author = {\ttfamily ''}, }
\item[{\$}]{license = {\ttfamily ''}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static]}}\label{classOWLinstaller_a4ed45e29611ce17a8edf24e51979a5d7}
\doxyref{Register}{p.}{classRegister} an application in the database 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$code} & Application code \\
\hline
\mbox{\tt in}  & {\em \$name} & Name of the application \\
\hline
\mbox{\tt in}  & {\em \$version} & Version number of the application \\
\hline
\mbox{\tt in}  & {\em \$description} & Optional description \\
\hline
\mbox{\tt in}  & {\em \$link} & Optional link to the applications homepage \\
\hline
\mbox{\tt in}  & {\em \$author} & Optional name of the copyright holder \\
\hline
\mbox{\tt in}  & {\em \$license} & Optional license \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The application ID 
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}
\begin{Desc}
\item[{\bf Todo}]Error checking \end{Desc}


References ConfigHandler::get().

\index{OWLinstaller@{OWLinstaller}!installTables@{installTables}}
\index{installTables@{installTables}!OWLinstaller@{OWLinstaller}}
\subsubsection[{installTables}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::installTables (
\begin{DoxyParamCaption}
\item[{\$}]{sqlFile, }
\item[{\$}]{prefix = {\ttfamily null}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static]}}\label{classOWLinstaller_ac7b18c361051e050b6e9ee54224b2a7f}
Execute the queries from a given SQL file to install all tables for this application 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$sqlFile} & Full path specification of the file containing SQL statements \\
\hline
\mbox{\tt in}  & {\em \$prefix} & Table prefix to add if it's not in the SQL file. Specify 'false' to disable adding the prefix \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Boolean indicating success (true) or any failure (false) 
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}


References addTablePrefix(), OWL::factory(), and OWLdbg\_\-add().

\index{OWLinstaller@{OWLinstaller}!parseSQLFile@{parseSQLFile}}
\index{parseSQLFile@{parseSQLFile}!OWLinstaller@{OWLinstaller}}
\subsubsection[{parseSQLFile}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::parseSQLFile (
\begin{DoxyParamCaption}
\item[{\$}]{fname}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static]}}\label{classOWLinstaller_a80d3dddb1d0c88cd216261beef8a19cb}
Parse a given SQL file 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$fname} & Full path specification of the file containing SQL statements \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array with all SQL statements from the file, or null when an error occured 
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}


References OWLdbg\_\-add(), and uncommentSQL().

\index{OWLinstaller@{OWLinstaller}!uncommentSQL@{uncommentSQL}}
\index{uncommentSQL@{uncommentSQL}!OWLinstaller@{OWLinstaller}}
\subsubsection[{uncommentSQL}]{\setlength{\rightskip}{0pt plus 5cm}static OWLinstaller::uncommentSQL (
\begin{DoxyParamCaption}
\item[{\$}]{line}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [static, private]}}\label{classOWLinstaller_a62699be0fe7e64f36d61f56a87d4fd77}
Parse a line from an SQL file, stripping all comments 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \$line} & Line as read from the SQL file \\
\hline
\end{DoxyParams}
\begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}
\begin{DoxyReturn}{Returns}
String with a (part of the) SQL statement 
\end{DoxyReturn}


Referenced by parseSQLFile().



\subsection{Member Data Documentation}
\index{OWLinstaller@{OWLinstaller}!\$groups@{\$groups}}
\index{\$groups@{\$groups}!OWLinstaller@{OWLinstaller}}
\subsubsection[{\$groups}]{\setlength{\rightskip}{0pt plus 5cm}OWLinstaller::\$groups = array()\hspace{0.3cm}{\ttfamily  [static, private]}}\label{classOWLinstaller_a29b2720adafc2e12f426b719bc1761bd}
Array with registered groups and their IDs \index{OWLinstaller@{OWLinstaller}!\$rights@{\$rights}}
\index{\$rights@{\$rights}!OWLinstaller@{OWLinstaller}}
\subsubsection[{\$rights}]{\setlength{\rightskip}{0pt plus 5cm}OWLinstaller::\$rights = array()\hspace{0.3cm}{\ttfamily  [static, private]}}\label{classOWLinstaller_a17096619ba831be33e941b7719fd32bf}
Array with registered rights and their bitvalues 

The documentation for this class was generated from the following file:\begin{DoxyCompactItemize}
\item 
/home/oscar/projects/owl-\/php/src/{\bf OWLinstaller.php}\end{DoxyCompactItemize}
