\section{DbHandler Class Reference}
\label{classDbHandler}\index{DbHandler@{DbHandler}}


Database handler.  




Inheritance diagram for DbHandler:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=400pt]{classDbHandler__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for DbHandler:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=400pt]{classDbHandler__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDbHandler_ae54e9d4643f41a9296167086f6a769fc}{\_\-\_\-construct} (\$srv= 'localhost', \$db= '', \$usr= '', \$pwd= '', \$dbtype= 'MySQL')
\item 
\hyperlink{classDbHandler_a7cd6bd727d1f296eb5dbfae6ca36ab3f}{\_\-\_\-destruct} ()
\item 
\hyperlink{classDbHandler_ada20e62b915bc87a1de28389a2ee81e1}{\_\-\_\-clone} ()
\item 
\hyperlink{classDbHandler_ac9e93cb0ab57f03b2719eebd0c0ee2ef}{create} ()
\item 
\hyperlink{classDbHandler_aa342b2bd73c5f8ce05cadcba02f9cf5a}{is\_\-open} ()
\item 
\hyperlink{classDbHandler_afccbfc69ead84f8445116e050d1cfc2d}{open} ()
\item 
\hyperlink{classDbHandler_a9982df4830f05803935bb31bac7fae3d}{reset} ()
\item 
\hyperlink{classDbHandler_abaca15a312800e5522b3efd9dff036f5}{tablename} (\$tablename)
\item 
\hyperlink{classDbHandler_a305a3225c4760a88a06b0d55d0893962}{set\_\-query} (\$qry)
\item 
\hyperlink{classDbHandler_a5ebfdc2acfcb0e9cbc2861fc55c7127c}{read} (\$flag=\hyperlink{class_8dbhandler_8php_acc5178c2a582eafa4ef488ed3394b725}{DBHANDLE\_\-DATA}, \&\$data, \$quick\_\-query= '', \$line=0, \$file= '\mbox{[}unknown\mbox{]}')
\item 
\hyperlink{classDbHandler_a11e750a2c46022241eba49df81607ba9}{table\_\-exists} (\$tablename)
\item 
\hyperlink{classDbHandler_a67d77702ff6db70f89123d3f947af143}{escape\_\-string} (\$string)
\item 
\hyperlink{classDbHandler_a27c604b14c39913d34630e5504979b15}{unescape\_\-string} (\$string)
\item 
\hyperlink{classDbHandler_a3f9a0832d2de73e1f698b6d3c33569e6}{prepare\_\-read} (\$values=array(), \$tables=array(), \$searches=array(), \$joins=array())
\item 
\hyperlink{classDbHandler_a973e07b361c889b6ff44e93cc7665ca4}{prepare\_\-delete} (\$searches=array())
\item 
\hyperlink{classDbHandler_a9bddaca38be2544f6fdd4d82b3cd1c50}{prepare\_\-update} (\$values=array(), \$searches=array(), \$joins=array())
\item 
\hyperlink{classDbHandler_a79e3237271c150c4f4f6c2593060567e}{prepare\_\-insert} (\$values=array())
\item 
\hyperlink{classDbHandler_a654166283f0f61f918cc34a5071f838c}{write} (\$rows=false, \$line=0, \$file= '\mbox{[}unknown\mbox{]}')
\item 
\hyperlink{classDbHandler_ad6be57a8dbb86dc1648c79b96128fc97}{last\_\-inserted\_\-id} ()
\item 
\hyperlink{classDbHandler_ad3d2853bbd2d1962710907e34afb424f}{close} ()
\item 
\hyperlink{class__OWL_a99ec771fa2c5c279f80152cc09e489a8}{get\_\-status} ()
\item 
\hyperlink{class__OWL_adf9509ef96858be7bdd9414c5ef129aa}{get\_\-severity} (\$status=null)
\item 
\hyperlink{class__OWL_a51ba4a16409acf2a2f61f286939091a5}{signal} (\$level=\hyperlink{owl_8severitycodes_8php_a139328861128689f2f4def6a399d9057}{OWL\_\-INFO}, \&\$text=false)
\item 
\hyperlink{class__OWL_aa29547995d6741b7d2b90c1d4ea99a13}{traceback} (\&\$text=false, \$depth=0)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classDbHandler_ae9bfc8bdc6a8077adb342702aaffc9af}{get\_\-instance} ()
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class__OWL_ae0ef3ded56e8a6b34b6461e5a721cd3e}{init} ()
\item 
\hyperlink{class__OWL_ad6f4f6946f40199dd0333cf219fa500e}{check} (\&\$object, \$level)
\item 
\hyperlink{class__OWL_aea912d0ede9b3c2a69b79072d94d4787}{set\_\-status} (\$status, \$params=array())
\item 
\hyperlink{class__OWL_a576829692a3b66e3d518853bf43abae3}{set\_\-high\_\-severity} (\&\$object=null)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class__OWL_ad26b40a9dbbacb33e299b17826f8327c}{\$severity}
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDbHandler_a9cf52ba614981a0082063d57290d3b7c}{connect} ()
\item 
\hyperlink{classDbHandler_a130e49aa639fecb46ce6719ddcb0d72f}{dbread} (\$qry, \&\$rows, \&\$fields)
\item 
\hyperlink{classDbHandler_a7896419cf143412ad74ca8fccb11fb6e}{expand\_\-field} (\&\$field, \$quotes=false)
\item 
\hyperlink{classDbHandler_a2b6376ab821eb4aa2f086d852099c6c1}{tablelist} (\$tables)
\item 
\hyperlink{classDbHandler_a7715991ea990f6610a95844bebd75800}{where\_\-clause} (\$searches, \$joins)
\item 
\hyperlink{classDbHandler_aa734a4d3767057b811be5b4621d55cdd}{update\_\-list} (\$updates)
\item 
\hyperlink{classDbHandler_af7a315d2a47dc9f2d2f897ca87981c00}{extract\_\-tablelist} (\$fields)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDbHandler_ad38e1c3312815c8ad4093957881092ff}{\$id}
\item 
\hyperlink{classDbHandler_af6e9f493be56617cb533763bb2a0e85a}{\$errno}
\item 
\hyperlink{classDbHandler_ade79e11156abbfc180864beb5b9df377}{\$error}
\item 
\hyperlink{classDbHandler_afaac5248f9ee59786b48a7b51f318940}{\$database}
\item 
\hyperlink{classDbHandler_a56a7ae4bd7d842c85f3fe8052aecbfef}{\$rowcount}
\item 
\hyperlink{classDbHandler_a71e36ffbff0d157b1d91dc000bc6f821}{\$opened}
\item 
\hyperlink{classDbHandler_a19af96598e7f72673fc5da26ad77731b}{\$db\_\-prefix}
\item 
\hyperlink{classDbHandler_ad671b5596b37dac6d48a660a07775965}{\$query}
\end{DoxyCompactItemize}
\subsection*{Static Private Attributes}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classDbHandler_a0859a862eac3e8ba14c6d04de0396710}{\$instance}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Database handler. Handler for all database I/O. This singleton class uses an (abstract) class for the actual storage. \begin{DoxyAuthor}{Author}
Oscar van Eijk, Oveas Functionality Provider 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
May 15, 2007 -\/-\/ O van Eijk -\/-\/ initial version for Terra-\/Terra 

Jul 29, 2008 -\/-\/ O van Eijk -\/-\/ Modified version for \hyperlink{classOWL}{OWL} 
\end{DoxyVersion}


\subsection{Constructor \& Destructor Documentation}
\index{DbHandler@{DbHandler}!\_\-\_\-construct@{\_\-\_\-construct}}
\index{\_\-\_\-construct@{\_\-\_\-construct}!DbHandler@{DbHandler}}
\subsubsection[{\_\-\_\-construct}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\_\-\_\-construct (\$ {\em srv} = {\ttfamily 'localhost'}, \/  \$ {\em db} = {\ttfamily ''}, \/  \$ {\em usr} = {\ttfamily ''}, \/  \$ {\em pwd} = {\ttfamily ''}, \/  \$ {\em dbtype} = {\ttfamily 'MySQL'})}\label{classDbHandler_ae54e9d4643f41a9296167086f6a769fc}
Class constructor; opens the database connection.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$srv}]Database server \item[\mbox{$\leftarrow$} {\em \$db}]Database name \item[\mbox{$\leftarrow$} {\em \$usr}]Username to connect with \item[\mbox{$\leftarrow$} {\em \$pwd}]Password to use for connection \item[\mbox{$\leftarrow$} {\em \$dbtype}]Database type (reserved for future use, currently only MySQL is implemented) \end{DoxyParams}


References ConfigHandler::get(), \_\-OWL::init(), and \_\-OWL::set\_\-status().

\index{DbHandler@{DbHandler}!\_\-\_\-destruct@{\_\-\_\-destruct}}
\index{\_\-\_\-destruct@{\_\-\_\-destruct}!DbHandler@{DbHandler}}
\subsubsection[{\_\-\_\-destruct}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\_\-\_\-destruct ()}\label{classDbHandler_a7cd6bd727d1f296eb5dbfae6ca36ab3f}
Class destructor; closes the database connection 

Reimplemented from \hyperlink{class__OWL_a44fd2222476a3109286cc82d92b6bbcc}{\_\-OWL}.



References close().



\subsection{Member Function Documentation}
\index{DbHandler@{DbHandler}!\_\-\_\-clone@{\_\-\_\-clone}}
\index{\_\-\_\-clone@{\_\-\_\-clone}!DbHandler@{DbHandler}}
\subsubsection[{\_\-\_\-clone}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\_\-\_\-clone ()}\label{classDbHandler_ada20e62b915bc87a1de28389a2ee81e1}
Implementation of the \hyperlink{classDbHandler_ada20e62b915bc87a1de28389a2ee81e1}{\_\-\_\-clone()} function to prevent cloning of this singleton; it triggers a fatal (user)error \index{DbHandler@{DbHandler}!check@{check}}
\index{check@{check}!DbHandler@{DbHandler}}
\subsubsection[{check}]{\setlength{\rightskip}{0pt plus 5cm}\_\-OWL::check (\&\$ {\em object}, \/  \$ {\em level})\hspace{0.3cm}{\ttfamily  \mbox{[}protected, inherited\mbox{]}}}\label{class__OWL_ad6f4f6946f40199dd0333cf219fa500e}
This is a helper function for lazy developers. Some checks have to be made quite often, this is a kinda macro to handle that. It compares the own severity level with that of a given object. If the highest level is above a given max, a traceback and reset are performed.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$object}]Pointer to an object to check against \item[\mbox{$\leftarrow$} {\em \$level}]The maximum severity level \end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the severity level was correct ( below the max), otherwise false 
\end{DoxyReturn}


References \_\-OWL::reset(), \_\-OWL::set\_\-high\_\-severity(), and \_\-OWL::traceback().



Referenced by SessionHandler::write().

\index{DbHandler@{DbHandler}!close@{close}}
\index{close@{close}!DbHandler@{DbHandler}}
\subsubsection[{close}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::close ()}\label{classDbHandler_ad3d2853bbd2d1962710907e34afb424f}
Close the database and disconnect from the server. This function is called on program shutdown. Although the database will be closed already by PHP, this function might be called at any time manually; is also updates the 'opened' variable. 

Referenced by \_\-\_\-destruct(), and create().

\index{DbHandler@{DbHandler}!connect@{connect}}
\index{connect@{connect}!DbHandler@{DbHandler}}
\subsubsection[{connect}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::connect ()\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_a9cf52ba614981a0082063d57290d3b7c}
Connect to the database server

\begin{DoxyReturn}{Returns}
True on success, otherwise False 
\end{DoxyReturn}


References ConfigHandler::get(), and \_\-OWL::set\_\-status().



Referenced by create(), and open().

\index{DbHandler@{DbHandler}!create@{create}}
\index{create@{create}!DbHandler@{DbHandler}}
\subsubsection[{create}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::create ()}\label{classDbHandler_ac9e93cb0ab57f03b2719eebd0c0ee2ef}
Create a new database

\begin{DoxyReturn}{Returns}
Severity level 
\end{DoxyReturn}


References close(), connect(), and \_\-OWL::set\_\-status().

\index{DbHandler@{DbHandler}!dbread@{dbread}}
\index{dbread@{dbread}!DbHandler@{DbHandler}}
\subsubsection[{dbread}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::dbread (\$ {\em qry}, \/  \&\$ {\em rows}, \/  \&\$ {\em fields})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_a130e49aa639fecb46ce6719ddcb0d72f}
Read from the database.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$qry}]Database query string. \item[\mbox{$\rightarrow$} {\em \$rows}]Number of rows matched \item[\mbox{$\rightarrow$} {\em \$fields}]Number of fields per row \end{DoxyParams}
\begin{DoxyReturn}{Returns}
A 2D array with all data, or false on failures 
\end{DoxyReturn}


Referenced by read(), and table\_\-exists().

\index{DbHandler@{DbHandler}!escape\_\-string@{escape\_\-string}}
\index{escape\_\-string@{escape\_\-string}!DbHandler@{DbHandler}}
\subsubsection[{escape\_\-string}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::escape\_\-string (\$ {\em string})}\label{classDbHandler_a67d77702ff6db70f89123d3f947af143}
Call the current DBtype's escape function for character strings.


\begin{DoxyParams}{Parameters}
\item[{\em \$string}]The string that should be escaped \end{DoxyParams}
\begin{DoxyReturn}{Returns}
The escaped string 
\end{DoxyReturn}
\index{DbHandler@{DbHandler}!expand\_\-field@{expand\_\-field}}
\index{expand\_\-field@{expand\_\-field}!DbHandler@{DbHandler}}
\subsubsection[{expand\_\-field}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::expand\_\-field (\&\$ {\em field}, \/  \$ {\em quotes} = {\ttfamily false})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_a7896419cf143412ad74ca8fccb11fb6e}
Change a fieldname in the format 'table\#field' to the format '`\mbox{[}prefix\mbox{]}table.field`' 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em \$field}]Fieldname to expand \item[\mbox{$\leftarrow$} {\em \$quotes}]If true, add backquotes \end{DoxyParams}


References \$\_\-t, and tablename().



Referenced by prepare\_\-insert(), prepare\_\-read(), update\_\-list(), and where\_\-clause().

\index{DbHandler@{DbHandler}!extract\_\-tablelist@{extract\_\-tablelist}}
\index{extract\_\-tablelist@{extract\_\-tablelist}!DbHandler@{DbHandler}}
\subsubsection[{extract\_\-tablelist}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::extract\_\-tablelist (\$ {\em fields})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_af7a315d2a47dc9f2d2f897ca87981c00}
Create an array with unique tablenames as extracted from an array of fields in the format (table::field =$>$ value, ...) 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$fields}]An array with fields \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Array with tablenames 
\end{DoxyReturn}


References \$\_\-t, and \$\_\-table.



Referenced by prepare\_\-delete(), prepare\_\-insert(), and prepare\_\-update().

\index{DbHandler@{DbHandler}!get\_\-instance@{get\_\-instance}}
\index{get\_\-instance@{get\_\-instance}!DbHandler@{DbHandler}}
\subsubsection[{get\_\-instance}]{\setlength{\rightskip}{0pt plus 5cm}static DbHandler::get\_\-instance ()\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}\label{classDbHandler_ae9bfc8bdc6a8077adb342702aaffc9af}
Return a reference to my implementation. If necessary, create that implementation first.

\begin{DoxyReturn}{Returns}
Object instance ID 
\end{DoxyReturn}


References \$instance, and ConfigHandler::get().

\index{DbHandler@{DbHandler}!get\_\-severity@{get\_\-severity}}
\index{get\_\-severity@{get\_\-severity}!DbHandler@{DbHandler}}
\subsubsection[{get\_\-severity}]{\setlength{\rightskip}{0pt plus 5cm}\_\-OWL::get\_\-severity (\$ {\em status} = {\ttfamily null})\hspace{0.3cm}{\ttfamily  \mbox{[}inherited\mbox{]}}}\label{class__OWL_adf9509ef96858be7bdd9414c5ef129aa}
Get the current object severity level.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$status}]An optional parameter to check an other status code i.s.o the object's current status. \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status severity level 
\end{DoxyReturn}


References \_\-OWL::\$status.



Referenced by LogHandler::compose\_\-message(), LogHandler::log(), and DataHandler::set\_\-key().

\index{DbHandler@{DbHandler}!get\_\-status@{get\_\-status}}
\index{get\_\-status@{get\_\-status}!DbHandler@{DbHandler}}
\subsubsection[{get\_\-status}]{\setlength{\rightskip}{0pt plus 5cm}\_\-OWL::get\_\-status ()\hspace{0.3cm}{\ttfamily  \mbox{[}final, inherited\mbox{]}}}\label{class__OWL_a99ec771fa2c5c279f80152cc09e489a8}
Get the current object status.

\begin{DoxyReturn}{Returns}
Object's status code 
\end{DoxyReturn}


Referenced by SchemeHandler::compare().

\index{DbHandler@{DbHandler}!init@{init}}
\index{init@{init}!DbHandler@{DbHandler}}
\subsubsection[{init}]{\setlength{\rightskip}{0pt plus 5cm}\_\-OWL::init ()\hspace{0.3cm}{\ttfamily  \mbox{[}protected, inherited\mbox{]}}}\label{class__OWL_ae0ef3ded56e8a6b34b6461e5a721cd3e}
This function should be called by all constuctors. It initializes the general characteristics. Status is 'warning' by default, it's up to the contructor to set a proper status; if it's still 'warning', this $\ast$might$\ast$ indicate something went wrong. 

References OWL::factory().



Referenced by UserHandler::\_\-\_\-construct(), SessionHandler::\_\-\_\-construct(), SchemeHandler::\_\-\_\-construct(), LogHandler::\_\-\_\-construct(), ImageHandler::\_\-\_\-construct(), FormHandler::\_\-\_\-construct(), FileHandler::\_\-\_\-construct(), \_\-\_\-construct(), OWL::\_\-\_\-construct(), Dispatcher::\_\-\_\-construct(), and DataHandler::DataHandler().

\index{DbHandler@{DbHandler}!is\_\-open@{is\_\-open}}
\index{is\_\-open@{is\_\-open}!DbHandler@{DbHandler}}
\subsubsection[{is\_\-open}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::is\_\-open ()}\label{classDbHandler_aa342b2bd73c5f8ce05cadcba02f9cf5a}
Let other objects check if th database connection is opened

\begin{DoxyReturn}{Returns}
boolean, True when opened 
\end{DoxyReturn}
\index{DbHandler@{DbHandler}!last\_\-inserted\_\-id@{last\_\-inserted\_\-id}}
\index{last\_\-inserted\_\-id@{last\_\-inserted\_\-id}!DbHandler@{DbHandler}}
\subsubsection[{last\_\-inserted\_\-id}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::last\_\-inserted\_\-id ()}\label{classDbHandler_ad6be57a8dbb86dc1648c79b96128fc97}
Return the last ID after a newly inserted record holding an AUTO\_\-INCREMENT field

\begin{DoxyReturn}{Returns}
The number that was last inserted 
\end{DoxyReturn}
\index{DbHandler@{DbHandler}!open@{open}}
\index{open@{open}!DbHandler@{DbHandler}}
\subsubsection[{open}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::open ()}\label{classDbHandler_afccbfc69ead84f8445116e050d1cfc2d}
Opens the database connection.

\begin{DoxyReturn}{Returns}
Severity level 
\end{DoxyReturn}


References connect(), and \_\-OWL::set\_\-status().



Referenced by read().

\index{DbHandler@{DbHandler}!prepare\_\-delete@{prepare\_\-delete}}
\index{prepare\_\-delete@{prepare\_\-delete}!DbHandler@{DbHandler}}
\subsubsection[{prepare\_\-delete}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::prepare\_\-delete (\$ {\em searches} = {\ttfamily array()})}\label{classDbHandler_a973e07b361c889b6ff44e93cc7665ca4}
Prepare a delete query. Data is taken from the arrays that are passed to this function. All fieldnames are in the format 'table\#field', where the table is not yet prefixed.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$searches}]Given values that have to match \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Severity level 
\end{DoxyReturn}


References extract\_\-tablelist(), \_\-OWL::set\_\-status(), tablelist(), and where\_\-clause().

\index{DbHandler@{DbHandler}!prepare\_\-insert@{prepare\_\-insert}}
\index{prepare\_\-insert@{prepare\_\-insert}!DbHandler@{DbHandler}}
\subsubsection[{prepare\_\-insert}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::prepare\_\-insert (\$ {\em values} = {\ttfamily array()})}\label{classDbHandler_a79e3237271c150c4f4f6c2593060567e}
Prepare an insert query. Data is taken from the arrays that are passed to this function. All fieldnames are in the format 'table\#field', where the table is not yet prefixed.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$values}]Given database values \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Severity level 
\end{DoxyReturn}


References expand\_\-field(), extract\_\-tablelist(), \_\-OWL::set\_\-status(), and tablename().

\index{DbHandler@{DbHandler}!prepare\_\-read@{prepare\_\-read}}
\index{prepare\_\-read@{prepare\_\-read}!DbHandler@{DbHandler}}
\subsubsection[{prepare\_\-read}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::prepare\_\-read (\$ {\em values} = {\ttfamily array()}, \/  \$ {\em tables} = {\ttfamily array()}, \/  \$ {\em searches} = {\ttfamily array()}, \/  \$ {\em joins} = {\ttfamily array()})}\label{classDbHandler_a3f9a0832d2de73e1f698b6d3c33569e6}
Prepare a read query. Data is taken from the arrays that are passed to this function. All fieldnames are in the format 'table\#field', where the table is not yet prefixed.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$values}]Values that will be read \item[\mbox{$\leftarrow$} {\em \$tables}]Tables from which will be read \item[\mbox{$\leftarrow$} {\em \$searches}]Given values that have to match \item[\mbox{$\leftarrow$} {\em \$joins}]Joins on the given tables \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Severity level 
\end{DoxyReturn}


References expand\_\-field(), \_\-OWL::set\_\-status(), tablelist(), and where\_\-clause().

\index{DbHandler@{DbHandler}!prepare\_\-update@{prepare\_\-update}}
\index{prepare\_\-update@{prepare\_\-update}!DbHandler@{DbHandler}}
\subsubsection[{prepare\_\-update}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::prepare\_\-update (\$ {\em values} = {\ttfamily array()}, \/  \$ {\em searches} = {\ttfamily array()}, \/  \$ {\em joins} = {\ttfamily array()})}\label{classDbHandler_a9bddaca38be2544f6fdd4d82b3cd1c50}
Prepare an update query. Data is taken from the arrays that are passed to this function. All fieldnames are in the format 'table\#field', where the table is not yet prefixed.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$values}]Given database values \item[\mbox{$\leftarrow$} {\em \$searches}]List of fieldnames that will be used in the where clause. All fields not in this array will be updated! \item[\mbox{$\leftarrow$} {\em \$joins}]Joins on the given tables \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Severity level 
\end{DoxyReturn}


References extract\_\-tablelist(), \_\-OWL::set\_\-status(), tablelist(), update\_\-list(), and where\_\-clause().

\index{DbHandler@{DbHandler}!read@{read}}
\index{read@{read}!DbHandler@{DbHandler}}
\subsubsection[{read}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::read (\$ {\em flag} = {\ttfamily {\bf DBHANDLE\_\-DATA}}, \/  \&\$ {\em data}, \/  \$ {\em quick\_\-query} = {\ttfamily ''}, \/  \$ {\em line} = {\ttfamily 0}, \/  \$ {\em file} = {\ttfamily '\mbox{[}unknown\mbox{]}'})}\label{classDbHandler_a5ebfdc2acfcb0e9cbc2861fc55c7127c}
Read from the database. The return value depends on the flag. By default, the selected rows(s) are returned in a 2d array.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$flag}]Flag that identifies how data should be returned; as data (default) or the number of rows \item[\mbox{$\rightarrow$} {\em \$data}]The retrieved value in a formatt depending on the flag:
\begin{DoxyItemize}
\item DBHANDLE\_\-ROWCOUNT; Number of matching rows
\item DBHANDLE\_\-FIELDCOUNT; Number of fields per rows
\item DBHANDLE\_\-TOTALFIELDCOUNT; Total number op fields
\item DBHANDLE\_\-DATA (default); A 2D array with all data
\item DBHANDLE\_\-SINGLEROW; The first matching row in a 1D array
\item DBHANDLE\_\-SINGLEFIELD; The first matching field 
\end{DoxyItemize}\item[\mbox{$\leftarrow$} {\em \$quick\_\-query}]Database query string. If empty, \$this-\/$>$query is used \item[\mbox{$\leftarrow$} {\em \$line}]Line number of this call \item[\mbox{$\leftarrow$} {\em \$file}]File that made the call to this method \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Severity level 
\end{DoxyReturn}


References dbread(), open(), and \_\-OWL::set\_\-status().

\index{DbHandler@{DbHandler}!reset@{reset}}
\index{reset@{reset}!DbHandler@{DbHandler}}
\subsubsection[{reset}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::reset ()}\label{classDbHandler_a9982df4830f05803935bb31bac7fae3d}
Reset the object 

Reimplemented from \hyperlink{class__OWL_a2f2a042bcf31965194c03033df0edc9b}{\_\-OWL}.

\index{DbHandler@{DbHandler}!set\_\-high\_\-severity@{set\_\-high\_\-severity}}
\index{set\_\-high\_\-severity@{set\_\-high\_\-severity}!DbHandler@{DbHandler}}
\subsubsection[{set\_\-high\_\-severity}]{\setlength{\rightskip}{0pt plus 5cm}\_\-OWL::set\_\-high\_\-severity (\&\$ {\em object} = {\ttfamily null})\hspace{0.3cm}{\ttfamily  \mbox{[}protected, inherited\mbox{]}}}\label{class__OWL_a576829692a3b66e3d518853bf43abae3}
Compare the severity level of the current object with a given one and set my statuspointer to the object with the highest level. 

Referenced by \_\-OWL::check(), DataHandler::db(), DataHandler::prepare(), and SessionHandler::read().

\index{DbHandler@{DbHandler}!set\_\-query@{set\_\-query}}
\index{set\_\-query@{set\_\-query}!DbHandler@{DbHandler}}
\subsubsection[{set\_\-query}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::set\_\-query (\$ {\em qry})}\label{classDbHandler_a305a3225c4760a88a06b0d55d0893962}
Set the database query. This function should only be used if the query is too complex to be set with any of the prepare() functions.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$qry}]A complete database query. All tablenames must be prefixed (with the \hyperlink{classDbHandler_abaca15a312800e5522b3efd9dff036f5}{tablename()} function)! \end{DoxyParams}
\index{DbHandler@{DbHandler}!set\_\-status@{set\_\-status}}
\index{set\_\-status@{set\_\-status}!DbHandler@{DbHandler}}
\subsubsection[{set\_\-status}]{\setlength{\rightskip}{0pt plus 5cm}\_\-OWL::set\_\-status (\$ {\em status}, \/  \$ {\em params} = {\ttfamily array~()})\hspace{0.3cm}{\ttfamily  \mbox{[}final, protected, inherited\mbox{]}}}\label{class__OWL_aea912d0ede9b3c2a69b79072d94d4787}
Set the current object status to the specified value.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$status}]\hyperlink{classOWL}{OWL} status code \item[\mbox{$\leftarrow$} {\em \$params}]\end{DoxyParams}


References \$GLOBALS, \_\-OWL::\$status, ConfigHandler::get(), Register::get\_\-code(), \_\-OWL::reset(), and \_\-OWL::signal().



Referenced by UserHandler::\_\-\_\-construct(), SessionHandler::\_\-\_\-construct(), SchemeHandler::\_\-\_\-construct(), ImageHandler::\_\-\_\-construct(), FormHandler::\_\-\_\-construct(), FileHandler::\_\-\_\-construct(), \_\-\_\-construct(), Form::addField(), SchemeHandler::alter\_\-scheme(), FileHandler::close(), connect(), create(), SchemeHandler::create\_\-scheme(), DataHandler::DataHandler(), SchemeHandler::define\_\-index(), SchemeHandler::define\_\-scheme(), Dispatcher::dispatch(), FormHandler::get(), DataHandler::get(), SchemeHandler::get\_\-table\_\-columns(), SchemeHandler::get\_\-table\_\-indexes(), UserHandler::login(), FileHandler::open(), open(), LogHandler::open\_\-logfile(), DataHandler::prepare(), prepare\_\-delete(), prepare\_\-insert(), prepare\_\-read(), prepare\_\-update(), read(), FileHandler::read\_\-line(), UserHandler::read\_\-userdata(), DataHandler::reset(), SchemeHandler::scheme(), FormHandler::set(), DataHandler::set(), DataHandler::set\_\-join(), DataHandler::set\_\-key(), Form::setFieldAttributes(), FormFieldText::setMaxsize(), FormFieldRadio::setSelected(), FormFieldText::setSize(), FormFieldSelect::setSize(), FormFieldSelect::setValue(), FormFieldRadio::setValue(), Form::showField(), SchemeHandler::table\_\-description(), SchemeHandler::validate\_\-scheme(), and write().

\index{DbHandler@{DbHandler}!signal@{signal}}
\index{signal@{signal}!DbHandler@{DbHandler}}
\subsubsection[{signal}]{\setlength{\rightskip}{0pt plus 5cm}\_\-OWL::signal (\$ {\em level} = {\ttfamily {\bf OWL\_\-INFO}}, \/  \&\$ {\em text} = {\ttfamily false})\hspace{0.3cm}{\ttfamily  \mbox{[}inherited\mbox{]}}}\label{class__OWL_a51ba4a16409acf2a2f61f286939091a5}
Display the message for the current object status


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$level}]An optional severity level; message will only be displayed when it is at least of this level. \item[\mbox{$\rightarrow$} {\em \$text}]If this parameter is given, the message text is returned in this string instead of echood. \end{DoxyParams}
\begin{DoxyReturn}{Returns}
The severity level for this object 
\end{DoxyReturn}


References ConfigHandler::get().



Referenced by \_\-OWL::set\_\-status(), and \_\-OWL::traceback().

\index{DbHandler@{DbHandler}!table\_\-exists@{table\_\-exists}}
\index{table\_\-exists@{table\_\-exists}!DbHandler@{DbHandler}}
\subsubsection[{table\_\-exists}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::table\_\-exists (\$ {\em tablename})}\label{classDbHandler_a11e750a2c46022241eba49df81607ba9}
Check if a table exists in the database 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$tablename}]Name of the table to check \end{DoxyParams}
\begin{DoxyReturn}{Returns}
True of the table exists 
\end{DoxyReturn}


References dbread(), and tablename().

\index{DbHandler@{DbHandler}!tablelist@{tablelist}}
\index{tablelist@{tablelist}!DbHandler@{DbHandler}}
\subsubsection[{tablelist}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::tablelist (\$ {\em tables})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_a2b6376ab821eb4aa2f086d852099c6c1}
Create a list with tables, including prefixes, that can be interpreted by SQL


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$tables}]An array with tablenames \end{DoxyParams}
\begin{DoxyReturn}{Returns}
The tablelist 
\end{DoxyReturn}


References \$\_\-table, and tablename().



Referenced by prepare\_\-delete(), prepare\_\-read(), and prepare\_\-update().

\index{DbHandler@{DbHandler}!tablename@{tablename}}
\index{tablename@{tablename}!DbHandler@{DbHandler}}
\subsubsection[{tablename}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::tablename (\$ {\em tablename})}\label{classDbHandler_abaca15a312800e5522b3efd9dff036f5}
Extend a tablename with the database prefix


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$tablename}]Table name to extend \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Extended table name 
\end{DoxyReturn}


Referenced by expand\_\-field(), prepare\_\-insert(), table\_\-exists(), and tablelist().

\index{DbHandler@{DbHandler}!traceback@{traceback}}
\index{traceback@{traceback}!DbHandler@{DbHandler}}
\subsubsection[{traceback}]{\setlength{\rightskip}{0pt plus 5cm}\_\-OWL::traceback (\&\$ {\em text} = {\ttfamily false}, \/  \$ {\em depth} = {\ttfamily 0})\hspace{0.3cm}{\ttfamily  \mbox{[}inherited\mbox{]}}}\label{class__OWL_aa29547995d6741b7d2b90c1d4ea99a13}
If somehwere in the nested calls an error occured, we can traceback the original failing object with this function and signal the message.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\rightarrow$} {\em \$text}]Optional variable in which the message text can be stored. If not given, the text will be written to standard output \item[\mbox{$\leftarrow$} {\em \$depth}]This paramater should be initially empty. It calculates the depth in recursive calls. \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Severity code of the failing object 
\end{DoxyReturn}


References \_\-OWL::signal().



Referenced by \_\-OWL::check(), UserHandler::login(), and SessionHandler::read().

\index{DbHandler@{DbHandler}!unescape\_\-string@{unescape\_\-string}}
\index{unescape\_\-string@{unescape\_\-string}!DbHandler@{DbHandler}}
\subsubsection[{unescape\_\-string}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::unescape\_\-string (\$ {\em string})}\label{classDbHandler_a27c604b14c39913d34630e5504979b15}
Call the current DBtype's unescape function for character strings.


\begin{DoxyParams}{Parameters}
\item[{\em \$string}]The string that should be unescaped \end{DoxyParams}
\begin{DoxyReturn}{Returns}
The unescaped string 
\end{DoxyReturn}
\index{DbHandler@{DbHandler}!update\_\-list@{update\_\-list}}
\index{update\_\-list@{update\_\-list}!DbHandler@{DbHandler}}
\subsubsection[{update\_\-list}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::update\_\-list (\$ {\em updates})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_aa734a4d3767057b811be5b4621d55cdd}
Create a string with 'field = value, ...' combinations in SQL format


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$updates}]Array with fields to update (fieldname =$>$ values) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
The UPDATE statement 
\end{DoxyReturn}


References expand\_\-field().



Referenced by prepare\_\-update().

\index{DbHandler@{DbHandler}!where\_\-clause@{where\_\-clause}}
\index{where\_\-clause@{where\_\-clause}!DbHandler@{DbHandler}}
\subsubsection[{where\_\-clause}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::where\_\-clause (\$ {\em searches}, \/  \$ {\em joins})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_a7715991ea990f6610a95844bebd75800}
Create a WHERE clause that can be interpreted by SQL


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em \$searches}]Array with values (fieldname =$>$ values) \item[\mbox{$\leftarrow$} {\em \$joins}]Array of arrays with values (field, linktype, field) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
The WHERE clause 
\end{DoxyReturn}


References expand\_\-field().



Referenced by prepare\_\-delete(), prepare\_\-read(), and prepare\_\-update().

\index{DbHandler@{DbHandler}!write@{write}}
\index{write@{write}!DbHandler@{DbHandler}}
\subsubsection[{write}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::write (\$ {\em rows} = {\ttfamily false}, \/  \$ {\em line} = {\ttfamily 0}, \/  \$ {\em file} = {\ttfamily '\mbox{[}unknown\mbox{]}'})}\label{classDbHandler_a654166283f0f61f918cc34a5071f838c}
Database inserts and updates. The number of affected rows is stored in \$this-\/$>$rowcount


\begin{DoxyParams}{Parameters}
\item[\mbox{$\rightarrow$} {\em \$rows}](optional) The number of affected rows \item[\mbox{$\leftarrow$} {\em \$line}]Line number of this call \item[\mbox{$\leftarrow$} {\em \$file}]File that made the call to this method \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Severity level 
\end{DoxyReturn}


References \_\-OWL::set\_\-status().



\subsection{Member Data Documentation}
\index{DbHandler@{DbHandler}!\$database@{\$database}}
\index{\$database@{\$database}!DbHandler@{DbHandler}}
\subsubsection[{\$database}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\$database\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_afaac5248f9ee59786b48a7b51f318940}
array -\/ Database location and authorization indo \index{DbHandler@{DbHandler}!\$db\_\-prefix@{\$db\_\-prefix}}
\index{\$db\_\-prefix@{\$db\_\-prefix}!DbHandler@{DbHandler}}
\subsubsection[{\$db\_\-prefix}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\$db\_\-prefix\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_a19af96598e7f72673fc5da26ad77731b}
string -\/ database prefix \index{DbHandler@{DbHandler}!\$errno@{\$errno}}
\index{\$errno@{\$errno}!DbHandler@{DbHandler}}
\subsubsection[{\$errno}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\$errno\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_af6e9f493be56617cb533763bb2a0e85a}
integer -\/ Error ID \index{DbHandler@{DbHandler}!\$error@{\$error}}
\index{\$error@{\$error}!DbHandler@{DbHandler}}
\subsubsection[{\$error}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\$error\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_ade79e11156abbfc180864beb5b9df377}
string -\/ Error text \index{DbHandler@{DbHandler}!\$id@{\$id}}
\index{\$id@{\$id}!DbHandler@{DbHandler}}
\subsubsection[{\$id}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\$id\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_ad38e1c3312815c8ad4093957881092ff}
integer -\/ DB Handle ID \index{DbHandler@{DbHandler}!\$instance@{\$instance}}
\index{\$instance@{\$instance}!DbHandler@{DbHandler}}
\subsubsection[{\$instance}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\$instance\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}\label{classDbHandler_a0859a862eac3e8ba14c6d04de0396710}
integer -\/ self reference 

Referenced by get\_\-instance().

\index{DbHandler@{DbHandler}!\$opened@{\$opened}}
\index{\$opened@{\$opened}!DbHandler@{DbHandler}}
\subsubsection[{\$opened}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\$opened\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_a71e36ffbff0d157b1d91dc000bc6f821}
boolean -\/ True if the database is opened \index{DbHandler@{DbHandler}!\$query@{\$query}}
\index{\$query@{\$query}!DbHandler@{DbHandler}}
\subsubsection[{\$query}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\$query\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_ad671b5596b37dac6d48a660a07775965}
string -\/ Query string \index{DbHandler@{DbHandler}!\$rowcount@{\$rowcount}}
\index{\$rowcount@{\$rowcount}!DbHandler@{DbHandler}}
\subsubsection[{\$rowcount}]{\setlength{\rightskip}{0pt plus 5cm}DbHandler::\$rowcount\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}\label{classDbHandler_a56a7ae4bd7d842c85f3fe8052aecbfef}
integer -\/ Row counter \index{DbHandler@{DbHandler}!\$severity@{\$severity}}
\index{\$severity@{\$severity}!DbHandler@{DbHandler}}
\subsubsection[{\$severity}]{\setlength{\rightskip}{0pt plus 5cm}\_\-OWL::\$severity\hspace{0.3cm}{\ttfamily  \mbox{[}protected, inherited\mbox{]}}}\label{class__OWL_ad26b40a9dbbacb33e299b17826f8327c}
Severity level of the current object status 

The documentation for this class was generated from the following file:\begin{DoxyCompactItemize}
\item 
/home/oscar/projects/owl-\/php/src/kernel/so/\hyperlink{class_8dbhandler_8php}{class.dbhandler.php}\end{DoxyCompactItemize}
